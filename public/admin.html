<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="연구실 자리 예약 시스템 - 관리자 페이지">
    <meta name="keywords" content="연구실, 자리예약, 관리자, 좌석관리">
    <meta name="author" content="SCLab">
    
    <!-- PWA 매니페스트 -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- 파비콘 -->
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    
    <title>관리자 페이지 - 연구실 자리 예약 시스템</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="admin.css">
    
    <!-- Socket.IO 클라이언트 -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- 다국어 지원 -->
    <script src="i18n.js"></script>
</head>
<body class="admin-page">
    <div class="container">
        <!-- 네비게이션 바 -->
        <nav class="navbar">
            <div class="nav-container">
                
                
                <!-- 햄버거 메뉴 버튼 -->
                <button class="hamburger" id="hamburger-menu" aria-label="메뉴 열기/닫기">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <!-- 네비게이션 메뉴 -->
                <div class="nav-menu" id="nav-menu">
                    <a href="index.html" class="nav-item">🏠 사용자 페이지</a>
                    <a href="#" class="nav-item" id="admin"> 관리자</a>
                    <div class="language-selector">
                        <button class="lang-btn active" id="lang-ko" onclick="changeLanguage('ko')">한국어</button>
                        <button class="lang-btn" id="lang-en" onclick="changeLanguage('en')">English</button>
                    </div>
                    <div class="nav-divider"></div>
                    <div class="auth-section">
                        <div class="login-status" id="login-status">
                            <span id="admin-greeting">관리자 모드</span>
                        </div>
                        <button class="auth-btn" id="admin-logout-btn" onclick="logout()">로그아웃</button>
                    </div>
                </div>

                <div class="nav-brand">SCLAB ADMIN</div>
            </div>
        </nav>

        <!-- 로그인 패널 -->
        <div id="login-panel" class="login-panel">
            <div class="login-form" id="login-form">
                <button class="close-login-btn" onclick="cancelLogin()" aria-label="로그인 취소">&times;</button>
                <h2 id="login-title">관리자 인증</h2>
                <div class="input-group">
                    <label for="admin-password" id="password-label">비밀번호:</label>
                    <input type="password" id="admin-password" placeholder="관리자 비밀번호 입력" maxlength="20">
                </div>
                <button onclick="authenticateAdmin()" class="login-btn" id="login-btn">로그인</button>
                <div id="login-error" class="error-message hidden"></div>
            </div>
        </div>

        <!-- 관리자 대시보드 -->
        <div id="admin-dashboard" class="admin-dashboard hidden">
            <!-- 연결 상태 -->
            <div class="connection-status">
                <div class="connection-indicator" id="connection-indicator"></div>
                <span id="connection-text">서버 연결 중...</span>
            </div>

            <!-- 시간 정보 -->
            <div class="time-info">
                <div class="current-time" id="admin-current-time">현재 시간: <span id="current-time"></span></div>
                <div class="session-info" id="admin-session-info">현재 세션: <span id="current-session"></span></div>
                <div class="next-reset" id="admin-next-reset">다음 리셋: <span id="next-reset"></span></div>
            </div>

            <!-- 점검 모드 알림 -->
            <div id="maintenance-notice" class="maintenance-notice hidden">
                ⚠️ 현재 점검 모드가 활성화되어 있습니다.
            </div>

            <!-- 통계 대시보드 -->
            <div class="stats-dashboard">
                <div class="stat-card">
                    <h3 id="occupancy-title">점유율</h3>
                    <div class="stat-value" id="occupancy-rate">0%</div>
                </div>
                <div class="stat-card">
                    <h3 id="reserved-seats-title">예약된 좌석</h3>
                    <div class="stat-value"><span id="occupied-seats">0</span>/13</div>
                </div>
                <div class="stat-card">
                    <h3 id="online-users-title">온라인 사용자</h3>
                    <div class="stat-value" id="online-users">0명</div>
                </div>
                <div class="stat-card">
                    <h3 id="server-status-title">서버 상태</h3>
                    <div class="stat-value server-status" id="server-status-text">정상</div>
                </div>
            </div>

            <!-- 좌석 현황 -->
            <div class="seat-overview">
                <h3 id="seat-overview-title">좌석 현황</h3>
                <div class="room-layout mini">
                    
                    <!-- 방 중앙의 2x2 배열 테이블 2개 -->
                    <div class="center-tables">
                        <div class="table-group" id="admin-table-group-1">
                            <div class="seats-grid table-2x2">
                                <div class="seat mini" data-seat="1">1</div>
                                <div class="seat mini" data-seat="2">2</div>
                                <div class="seat mini" data-seat="3">3</div>
                                <div class="seat mini" data-seat="4">4</div>
                            </div>
                        </div>
                        
                        <div class="table-group" id="admin-table-group-2">
                            <div class="seats-grid table-2x2">
                                <div class="seat mini" data-seat="5">5</div>
                                <div class="seat mini" data-seat="6">6</div>
                                <div class="seat mini" data-seat="7">7</div>
                                <div class="seat mini" data-seat="8">8</div>
                            </div>
                        </div>
                    </div>

                    <!-- 방 아래쪽의 1x5 배열과 출입구 -->
                    <div class="bottom-area">
                       
                        <!-- 1x5 좌석 (오른쪽) -->
                        <div class="bottom-table">
                            <div class="seats-grid table-1x5">
                                <div class="seat mini" data-seat="9">9</div>
                                <div class="seat mini" data-seat="10">10</div>
                                <div class="seat mini" data-seat="11">11</div>
                                <div class="seat mini" data-seat="12">12</div>
                                <div class="seat mini" data-seat="13">13</div>
                            </div>
                        </div>
                    </div>

                    
                </div>
            </div>

            <!-- 현재 예약자 목록 -->
            <div class="reservations-list">
                <h3 id="reservations-title">현재 예약자 목록</h3>
                <div id="current-reservations" class="reservations-container">
                    <p class="no-reservations" id="no-reservations-text">현재 예약이 없습니다.</p>
                </div>
            </div>

            <!-- 관리자 액션 -->
            <div class="admin-actions">
                <h3 id="admin-actions-title">관리 작업</h3>
                <div class="action-grid">
                    <button onclick="clearAllReservations()" class="action-btn danger" id="clear-all-btn">
                        🗑️ 전체 예약 초기화
                    </button>
                    <button onclick="forceSessionReset()" class="action-btn warning" id="force-session-btn">
                        🔄 세션 강제 변경
                    </button>
                    <button id="maintenance-btn" onclick="toggleMaintenanceMode()" class="action-btn">
                        🔧 점검 모드
                    </button>
                    <button onclick="showSeatAssignModal()" class="action-btn info" id="seat-assign-btn">
                        🎯 좌석 지정하기
                    </button>
                </div>
            </div>

            <!-- 좌석 지정 모달 -->
            <div id="seat-assign-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="seat-assign-modal-title">좌석 지정하기</h3>
                        <button class="close-btn" onclick="closeSeatAssignModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="assign-form">
                            <div class="form-group">
                                <label for="assign-seat-number" id="seat-number-label">좌석 번호:</label>
                                <select id="assign-seat-number">
                                    <option value="" id="select-seat-option">좌석을 선택하세요</option>
                                    <option value="1">1번 좌석</option>
                                    <option value="2">2번 좌석</option>
                                    <option value="3">3번 좌석</option>
                                    <option value="4">4번 좌석</option>
                                    <option value="5">5번 좌석</option>
                                    <option value="6">6번 좌석</option>
                                    <option value="7">7번 좌석</option>
                                    <option value="8">8번 좌석</option>
                                    <option value="9">9번 좌석</option>
                                    <option value="10">10번 좌석</option>
                                    <option value="11">11번 좌석</option>
                                    <option value="12">12번 좌석</option>
                                    <option value="13">13번 좌석</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="assign-student-name" id="student-name-label">학생 이름:</label>
                                <input type="text" id="assign-student-name" placeholder="학생 이름을 입력하세요" maxlength="20">
                            </div>
                            <div class="form-group">
                                <label for="assign-student-id" id="student-id-label">학번:</label>
                                <input type="text" id="assign-student-id" placeholder="학번을 입력하세요" maxlength="20">
                            </div>
                            <div class="form-group">
                                <label for="assign-start-date" id="start-date-label">시작일:</label>
                                <input type="date" id="assign-start-date">
                            </div>
                            <div class="form-group">
                                <label for="assign-end-date" id="end-date-label">종료일:</label>
                                <input type="date" id="assign-end-date">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="assign-permanent"> <span id="permanent-assign-label">영구 지정 (세션 만료 무시)</span>
                                </label>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <button onclick="assignSeat()" class="action-btn success" id="assign-confirm-btn">지정하기</button>
                            <button onclick="closeSeatAssignModal()" class="action-btn" id="assign-cancel-btn">취소</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 학생 관리 -->
            <div class="student-management">
                <h3 id="student-management-title">학생 관리</h3>
                
                <!-- 학생 추가 -->
                <div class="add-student-section">
                    <h4 id="add-student-title">새 학생 추가</h4>
                    <div class="add-student-form">
                        <div class="input-group">
                            <label for="new-student-id" id="new-student-id-label">학번:</label>
                            <input type="text" id="new-student-id" placeholder="예: 2023001" maxlength="20">
                        </div>
                        <div class="input-group">
                            <label for="new-student-name" id="new-student-name-label">이름:</label>
                            <input type="text" id="new-student-name" placeholder="예: 홍길동" maxlength="20">
                        </div>
                        <button onclick="addStudent()" class="action-btn success" id="add-student-btn">
                            ➕ 학생 추가
                        </button>
                    </div>
                </div>

                <!-- 학생 목록 -->
                <div class="students-list-section">
                    <h4 id="students-list-title">등록된 학생 목록</h4>
                    <div class="students-controls">
                        <button onclick="loadStudentsList()" class="action-btn" id="refresh-students-btn">
                            🔄 목록 새로고침
                        </button>
                        <div class="search-box">
                            <input type="text" id="student-search" placeholder="학번 또는 이름으로 검색..." onkeyup="filterStudents()">
                        </div>
                    </div>
                    <div id="students-list" class="students-list">
                        <div class="loading" id="students-loading">학생 목록을 불러오는 중...</div>
                    </div>
                </div>
            </div>

            <!-- 시스템 로그 -->
            <div class="system-logs">
                <h3 id="system-logs-title">시스템 로그</h3>
                <div id="log-container" class="log-container">
                    <div class="log-entry" id="system-start-log">시스템이 시작되었습니다.</div>
                </div>
                <button onclick="clearLogs()" class="clear-logs-btn" id="clear-logs-btn">로그 지우기</button>
            </div>
        </div>
    </div>

    <!-- 네비게이션 오버레이 -->
    <div class="nav-overlay" id="nav-overlay"></div>

    <!-- 관리자 스크립트 -->
    <script src="admin.js"></script>
</body>
</html>
